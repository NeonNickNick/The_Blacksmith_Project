本文档用于描述项目的整体开发流程，明确各阶段的任务划分，不涉及具体实现细节。

请先阅读

[剧情与肉鸽玩法](../01_剧情和玩法/00_剧情和肉鸽玩法.md)

[初始版玩法](../01_剧情和玩法/01_初始版玩法.md)

考虑到与美术同步的问题，本文档中指的任务都要留下与UI层交互的接口。
# 1 任务总结
## 1.1 肉鸽
这是一个肉鸽游戏，所以在最开始就要搭建一个肉鸽游戏框架。

为了让结构更加清楚，采用主控制器->子控制器->子控制器...的模式，其中主控制器和当前这一局是绑定关系。子控制器的任何任务必须由上一级控制器来指定，任务完成后回调。

我们没有同时保存多局游戏的需求，因此所有的肉鸽控制器都可以是唯一实例。

根据此前的文档，这个框架必须支持以下几种玩法：

### 1.1.1 种子
种子系统是一个关键系统，是整个游戏的生成来源。

这个游戏由种子生成。每局游戏只有一个种子实例。这个种子应该支持基本的随机数算法，例如生成0-1的随机浮点数。

所有涉及到随机事件的地方都应该使用这个种子来生成，除了默认情况种子是由C#随机数生成。

### 1.1.2 节点池和跳梦
节点池系统是一个关键系统，必须有良好的设计。

跳梦玩法要求有概率可变和指定节点两种模式的节点池。每一次事件结束后，实际上就要从节点池中抽一批节点出来。

节点池实际上也有自己子分类。首先要明确是什么类型的节点，然后再在这一种类型的节点中去选取。

进入节点这个过程需要有一个统一的设计来应对以后可能增加的节点类型。

### 1.1.3 倾向度系统
倾向度系统是一个相对好后期嵌入的系统。它可以通过给节点选项提供回调来记录玩家的倾向度。

### 1.1.4 信任度系统
信任度系统是一个相对好后期嵌入的系统。它可以给节点选项或战斗系统提供回调来计算阵营信任度。

### 1.1.5 游戏数据存储系统
游戏数据存储系统是一个关键系统，必须有良好的设计。

游戏数据主要包括三部分。第一部分是局内玩家身上的资源、甲、收藏品等，第二部分是策划指定的技能数值等，第三部分是与局外成长性有关的数据。

游戏数据存储系统要支持数据查询、数据局内修改和数据局外永久修改。

由于部分任务中可能会频繁操作数据，存储系统应该是二级式的。策划填入的Inspector数值或文档应该是只读的。游戏内访问的是它们的拷贝。

### 1.1.6 收藏品系统
收藏品系统是一个关键系统，必须有良好的设计。

数值增强类的收藏品是简单的，它主要设计和数据存储系统的交互。与剧情走向和职业有关的收藏品需要谨慎考虑。

### 1.1.7 时局系统
时局系统是一个相对好后期嵌入的系统。它主要限于修改局内数值。

## 1.1.8 文本和音乐系统
文本和音乐系统是一个相对好后期嵌入的系统。它们主要提供接口让游戏中需要的地方获取文本和音乐。

## 1.2 战斗系统
战斗节点虽然是肉鸽的一部分，但是它是最重要的一部分。主要的工作量应该在战斗节点的设计。

### 1.2.1 回合控制器
回合控制器主要用于双重回合制的战斗流程控制。


### 1.2.2 模块系统
模块系统是战斗玩法最重要的部分之一。详细内容参考文档

[初始版玩法](../01_剧情和玩法/01_初始版玩法.md)

这一部分的任务主要在于抽象出一个合适的数据结构。对于模块系统的程序化有一个已有的简易项目可以参考，请见团结云中的RLBlacksmith。我们需要预留对接美术的余地，同时要给技能系统提供尽量简单的输出。

### 1.2.3 技能系统
技能系统是战斗玩法最重要的部分之一。详细内容参考文档

[初始版玩法](../01_剧情和玩法/01_初始版玩法.md)

这一部分的任务主要在于复现老打铁的玩法。对于老打铁的程序化有一个已有的项目可以参考，请见团结云中的TheBlacksmithProject。我们需要在这个基础上改进出一个更加合理的结构，增强其扩展性，同时预留对接美术的余地。

# 2 起步阶段要完成的部分
主要是验证框架的合理性。需要一个游戏开始界面，节点选择界面，战斗节点来确定游戏流程是否正常。其余节点如果还没有被策划设计出来可以放一个空节点占位。

对于战斗节点，需要着重验证战斗逻辑是否正确。TheBlacksmithProject中的结构已经经过验证，能够正确处理技能系统的判定，因此可供参考。RLBlacksmith中的模块系统经过简单测试没有出现问题。因为这个系统比较程序员，出现问题的风险要明显小于技能系统。

到这一阶段结束之后，我们要得到一个看起来是肉鸽的游戏。除了战斗节点以外所有的节点都可以是空的。战斗节点内部要复现初始版玩法。